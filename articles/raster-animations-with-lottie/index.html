<!DOCTYPE >
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Downside of raster animations in Lottie</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/articles/css/style.css" type="text/css" media="screen">
    <link rel="stylesheet" href="/articles/styles/highlight.css">
    <link rel="stylesheet" href="/articles/styles/header.css">
    <link rel="stylesheet" href="/articles/styles/content.css">
    <link rel="stylesheet" href="/articles/styles/markdown.css">
    <style rel="stylesheet">
      mjx-container[jax="SVG"] > svg {
         max-width: 100%;
      }
    </style>
    <link rel="stylesheet" href="/articles/styles/typography.css">
    
  </head>

  <body>
    <layout>
      <header>
        <h1>
          Downside of raster animations in Lottie
        </h1>
      </header>
      <main>
        <article class="markdown">
          <h2>This article explores the downsides of using Lottie for raster animations</h2>
          <div class="content">
            <style>
    .side-by-side {
        display: flex;
        justify-content: space-between;
        flex-direction: row;
    }

    .side-by-side iframe {
        width: 50%;
    }
</style>
<p>Lottie is a powerful library that enables real-time rendering of animations using JSON files. It's an excellent tool for creating animations that are easily shareable across various platforms. However, like any technology, Lottie has its drawbacks. This article focuses on one particular issue: the potential downsides of using raster animations in Lottie.</p>
<p>Before diving in, it's important to have a basic understanding of the Lottie format and how it works. If you're new to Lottie, check out <a href="https://dev.to/stepancar/lottie-under-the-hood-4gik">this comprehensive guide</a> to get up to speed.</p>
<h2>Vector vs Raster Animations in Lottie</h2>
<p>Let's examine this bouncing heart animation:</p>
<p><demo-with-playground file="demos/bouncing-heart-large/index.html" initialPath="./demos/bouncing-heart-large/index.html"></demo-with-playground></p>
<p>You can view the source of this animation <a href="assets/bouncing-heart-large.json">here</a>. Here's a snippet of what it looks like:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"v"</span><span class="token operator">:</span> <span class="token string">"5.11.0"</span><span class="token punctuation">,</span>
  <span class="token property">"fr"</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
  <span class="token property">"ip"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"op"</span><span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
  <span class="token property">"w"</span><span class="token operator">:</span> <span class="token number">244</span><span class="token punctuation">,</span>
  <span class="token property">"h"</span><span class="token operator">:</span> <span class="token number">196</span><span class="token punctuation">,</span>
  <span class="token property">"nm"</span><span class="token operator">:</span> <span class="token string">"Heart"</span><span class="token punctuation">,</span>
  <span class="token property">"ddd"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"assets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"imgSeq_0"</span><span class="token punctuation">,</span>
      <span class="token property">"w"</span><span class="token operator">:</span> <span class="token number">410</span><span class="token punctuation">,</span>
      <span class="token property">"h"</span><span class="token operator">:</span> <span class="token number">364</span><span class="token punctuation">,</span>
      <span class="token property">"t"</span><span class="token operator">:</span> <span class="token string">"seq"</span><span class="token punctuation">,</span>
      <span class="token property">"u"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
      <span class="token property">"p"</span><span class="token operator">:</span> <span class="token string">"data:image/png;base64,...."</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"imgSeq_1"</span><span class="token punctuation">,</span>
      <span class="token property">"w"</span><span class="token operator">:</span> <span class="token number">410</span><span class="token punctuation">,</span>
      <span class="token property">"h"</span><span class="token operator">:</span> <span class="token number">364</span><span class="token punctuation">,</span>
      <span class="token property">"t"</span><span class="token operator">:</span> <span class="token string">"seq"</span><span class="token punctuation">,</span>
      <span class="token property">"u"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
      <span class="token property">"p"</span><span class="token operator">:</span> <span class="token string">"data:image/png;base64,...."</span>
    <span class="token punctuation">}</span>
    ...
    <span class="token punctuation">{</span>
      <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"imgSeq_23"</span><span class="token punctuation">,</span>
      <span class="token property">"w"</span><span class="token operator">:</span> <span class="token number">410</span><span class="token punctuation">,</span>
      <span class="token property">"h"</span><span class="token operator">:</span> <span class="token number">364</span><span class="token punctuation">,</span>
      <span class="token property">"t"</span><span class="token operator">:</span> <span class="token string">"seq"</span><span class="token punctuation">,</span>
      <span class="token property">"u"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
      <span class="token property">"p"</span><span class="token operator">:</span> <span class="token string">"data:image/png;base64,...."</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre>
<p>This animation consists of 24 separate images, each encoded as a base64 PNG. When the animation plays, the Lottie player loads and displays each image in sequence. Without Lottie, we could achieve a similar effect with JavaScript like this:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'../../assets/bouncing-heart-large.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>assets<span class="token punctuation">}</span> <span class="token operator">=</span> data<span class="token punctuation">;</span>

<span class="token keyword">const</span> image <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'animation'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> activeImage <span class="token operator">=</span> assets<span class="token punctuation">[</span>counter <span class="token operator">%</span> assets<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
    image<span class="token punctuation">.</span>src <span class="token operator">=</span> activeImage<span class="token punctuation">.</span>p<span class="token punctuation">;</span>

    counter<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><demo-with-playground file="demos/bouncing-heart-images-switch/index.html" initialPath="./demos/bouncing-heart-images-switch/index.html"></demo-with-playground></p>
<p>Alternatively, we could create separate image elements for each frame and display them sequentially. Feel free to experiment with optimizing this custom player.</p>
<p>The major drawback here is the file size: at 1.5MB, it's extremely large for such a simple animation. This bloat occurs because the designer exported the animation as a sequence of raster images instead of a vector animation. While this approach can sometimes be necessary for complex effects like 3D, it often leads to performance issues and oversized files.</p>
<p>Ideally, Lottie would support storing image sequences in a compressed format, similar to video files. This would significantly reduce file sizes and improve performance. Unfortunately, Lottie doesn't currently offer this feature.</p>
<p>There's an alternative called <a href="https://dotlottie.io/">dotlottie</a> that claims to be more efficient due to its binary format. However, it's a proprietary solution and not widely supported. Ideally, this kind of optimization would be built into Lottie itself.</p>
<h2>What Can Developers Do?</h2>
<p>The best approach is to work closely with designers, encouraging them to create vector animations whenever possible. This naturally leads to smaller file sizes and better performance.</p>
<p>When vector animations aren't feasible, look for creative compromises. In this case, we can achieve a similar effect using a single raster frame and animating its scale property:</p>
<p>Look at <a href="assets/compressed-heart-animation.json">this optimized animation</a>:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"v"</span><span class="token operator">:</span> <span class="token string">"5.11.0"</span><span class="token punctuation">,</span>
    <span class="token property">"fr"</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
    <span class="token property">"ip"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"op"</span><span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
    <span class="token property">"w"</span><span class="token operator">:</span> <span class="token number">335</span><span class="token punctuation">,</span>
    <span class="token property">"h"</span><span class="token operator">:</span> <span class="token number">240</span><span class="token punctuation">,</span>
    <span class="token property">"nm"</span><span class="token operator">:</span> <span class="token string">"Alfa Red Heart extra low"</span><span class="token punctuation">,</span>
    <span class="token property">"ddd"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"assets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"image_0"</span><span class="token punctuation">,</span>
            <span class="token property">"w"</span><span class="token operator">:</span> <span class="token number">410</span><span class="token punctuation">,</span>
            <span class="token property">"h"</span><span class="token operator">:</span> <span class="token number">364</span><span class="token punctuation">,</span>
            <span class="token property">"u"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
            <span class="token property">"p"</span><span class="token operator">:</span> <span class="token string">"data:image/png;base64,..."</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"layers"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"ddd"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"ind"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">"ty"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token property">"nm"</span><span class="token operator">:</span> <span class="token string">"HEART_main_page_00011.png"</span><span class="token punctuation">,</span>
            <span class="token property">"cl"</span><span class="token operator">:</span> <span class="token string">"png"</span><span class="token punctuation">,</span>
            <span class="token property">"refId"</span><span class="token operator">:</span> <span class="token string">"image_0"</span><span class="token punctuation">,</span> <span class="token comment">// reference to image asset</span>
            <span class="token property">"sr"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">"ks"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                ...
                <span class="token property">"s"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// scale key frames</span>
                    <span class="token property">"a"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token property">"k"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token punctuation">{</span>
                            <span class="token property">"i"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                                <span class="token property">"x"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0.08</span><span class="token punctuation">,</span>
                                    <span class="token number">0.08</span><span class="token punctuation">,</span>
                                    <span class="token number">0.25</span>
                                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token property">"y"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">1.022</span><span class="token punctuation">,</span>
                                    <span class="token number">1.024</span><span class="token punctuation">,</span>
                                    <span class="token number">1</span>
                                <span class="token punctuation">]</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token property">"o"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                                <span class="token property">"x"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0.31</span><span class="token punctuation">,</span>
                                    <span class="token number">0.31</span><span class="token punctuation">,</span>
                                    <span class="token number">0.75</span>
                                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token property">"y"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0</span><span class="token punctuation">,</span>
                                    <span class="token number">0</span><span class="token punctuation">,</span>
                                    <span class="token number">0</span>
                                <span class="token punctuation">]</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token property">"t"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                            <span class="token property">"s"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                <span class="token number">68.8</span><span class="token punctuation">,</span>
                                <span class="token number">68.8</span><span class="token punctuation">,</span>
                                <span class="token number">100</span>
                            <span class="token punctuation">]</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">{</span>
                            <span class="token property">"i"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                                <span class="token property">"x"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0.188</span><span class="token punctuation">,</span>
                                    <span class="token number">0.188</span><span class="token punctuation">,</span>
                                    <span class="token number">0.25</span>
                                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token property">"y"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">1</span><span class="token punctuation">,</span>
                                    <span class="token number">1</span><span class="token punctuation">,</span>
                                    <span class="token number">1</span>
                                <span class="token punctuation">]</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token property">"o"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                                <span class="token property">"x"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0.5</span><span class="token punctuation">,</span>
                                    <span class="token number">0.5</span><span class="token punctuation">,</span>
                                    <span class="token number">0.75</span>
                                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token property">"y"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0.003</span><span class="token punctuation">,</span>
                                    <span class="token number">0.004</span><span class="token punctuation">,</span>
                                    <span class="token number">0</span>
                                <span class="token punctuation">]</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token property">"t"</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
                            <span class="token property">"s"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                <span class="token number">56.8</span><span class="token punctuation">,</span>
                                <span class="token number">57.8</span><span class="token punctuation">,</span>
                                <span class="token number">100</span>
                            <span class="token punctuation">]</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">{</span>
                            <span class="token property">"i"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                                <span class="token property">"x"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0.399</span><span class="token punctuation">,</span>
                                    <span class="token number">0.399</span><span class="token punctuation">,</span>
                                    <span class="token number">0.25</span>
                                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token property">"y"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0.997</span><span class="token punctuation">,</span>
                                    <span class="token number">0.997</span><span class="token punctuation">,</span>
                                    <span class="token number">1</span>
                                <span class="token punctuation">]</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token property">"o"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                                <span class="token property">"x"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0.5</span><span class="token punctuation">,</span>
                                    <span class="token number">0.5</span><span class="token punctuation">,</span>
                                    <span class="token number">0.75</span>
                                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token property">"y"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0</span><span class="token punctuation">,</span>
                                    <span class="token number">0</span><span class="token punctuation">,</span>
                                    <span class="token number">0</span>
                                <span class="token punctuation">]</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token property">"t"</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
                            <span class="token property">"s"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                <span class="token number">68.8</span><span class="token punctuation">,</span>
                                <span class="token number">68.8</span><span class="token punctuation">,</span>
                                <span class="token number">100</span>
                            <span class="token punctuation">]</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">{</span>
                            <span class="token property">"i"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                                <span class="token property">"x"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0.163</span><span class="token punctuation">,</span>
                                    <span class="token number">0.163</span><span class="token punctuation">,</span>
                                    <span class="token number">0.25</span>
                                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token property">"y"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0.8</span><span class="token punctuation">,</span>
                                    <span class="token number">0.777</span><span class="token punctuation">,</span>
                                    <span class="token number">1</span>
                                <span class="token punctuation">]</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token property">"o"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                                <span class="token property">"x"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0.2</span><span class="token punctuation">,</span>
                                    <span class="token number">0.2</span><span class="token punctuation">,</span>
                                    <span class="token number">0.75</span>
                                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                                <span class="token property">"y"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                    <span class="token number">0.005</span><span class="token punctuation">,</span>
                                    <span class="token number">0.005</span><span class="token punctuation">,</span>
                                    <span class="token number">0</span>
                                <span class="token punctuation">]</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token property">"t"</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
                            <span class="token property">"s"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                <span class="token number">58.8</span><span class="token punctuation">,</span>
                                <span class="token number">59.8</span><span class="token punctuation">,</span>
                                <span class="token number">100</span>
                            <span class="token punctuation">]</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">{</span>
                            <span class="token property">"t"</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
                            <span class="token property">"s"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                <span class="token number">68.8</span><span class="token punctuation">,</span>
                                <span class="token number">68.8</span><span class="token punctuation">,</span>
                                <span class="token number">100</span>
                            <span class="token punctuation">]</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token property">"ix"</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
                    <span class="token property">"l"</span><span class="token operator">:</span> <span class="token number">2</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">"ao"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"ip"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"op"</span><span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
            <span class="token property">"st"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">"bm"</span><span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"markers"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"props"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre>
<p>This optimized version achieves a visually similar result, but the JSON file is now 30 times smaller â€“ a massive improvement in efficiency.</p>
<p><demo-with-playground file="demos/bouncing-heart-optimized/index.html" initialPath="./demos/bouncing-heart-optimized/index.html"></demo-with-playground></p>
<p>Here's a side-by-side comparison of the original and optimized animations:</p>
<div class="side-by-side">
    <iframe src="demos/bouncing-heart-large/index.html"></iframe>
    <iframe src="demos/bouncing-heart-optimized/index.html"></iframe>
</div>
<p>By making smart choices about how we create and export animations for Lottie, we can significantly improve performance without sacrificing visual quality.</p>

          </div>
        </article>
      </main>
      <footer></footer>
    </layout>

    <script>
        function resizeIframe(iframe) {
            const height = parseInt(iframe.style.height);
            const scrollHeight = iframe.contentWindow.document.documentElement.scrollHeight
            iframe.style.height = scrollHeight + 'px';
            console.log(height, scrollHeight)
            if (height < scrollHeight) {  
              console.log('resize')
              iframe.style.height = scrollHeight + 20 + 'px';
            }
        }

        setInterval(() => {
            const iframes = document.querySelectorAll('iframe');
            iframes.forEach((iframe) => {
              resizeIframe(iframe);
            });
        }, 100);


    class DemoWithPlayground extends HTMLElement {
      static get observedAttributes() {
        return ['initialPath', 'file'];
      }

      constructor() {
          super();
              // this.attachShadow({ mode: 'open' });
          }

          connectedCallback() {
              this.render();
          }

          attributeChangedCallback() {
              this.render();
          }

          render() {
              const initialPath = this.getAttribute('initialPath') || '';
              const file = this.getAttribute('file') || '';
          
          this.innerHTML = `
          <div>
              <iframe src="./${initialPath}"></iframe>

              <a href="https://stackblitz.com/github/stepancar/articles/tree/main/articles/raster-animations-with-lottie/?file=${file}&initialPath=${initialPath}&startScript=start" target="_blank">
              <img
                  alt="Open in StackBlitz"
                  src="https://developer.stackblitz.com/img/open_in_stackblitz.svg"
              />
              </a>
          </div>
          `;
          }
      }

    customElements.define('demo-with-playground', DemoWithPlayground);
    </script>
  </body>
</html>
